{"pageProps":{"blog":{"id":"vx-cloudflare-firebase","createdAt":"2025-06-12T03:05:46.804Z","updatedAt":"2025-06-12T05:45:31.143Z","publishedAt":"2025-06-12T03:05:55.903Z","revisedAt":"2025-06-12T03:06:23.400Z","title":"【Firebase】React Router+Firebase+Cloudflareで認証サイトを作った(2025-06-12時点)","content":"<h2 id=\"h250913c1dc\">やりかったこと</h2><p>私が開発しているWeb3 SDKであるVXのダッシュボードやドキュメントで使うアカウント連携機能用に認証アプリケーションを作る。</p><h2 id=\"h0c8fa4812e\">処理の流れ</h2><p>ドキュメントサイトなどでログインボタン押下 =&gt; 認証ページに遷移 =&gt; Google又はGitHubで認証 =&gt; 元のページに戻る</p><p>コールバックで元のページに戻った段階で裏で認証情報を読み取ります</p><h2 id=\"hc167090f26\">APIキーで詰んだ</h2><h3 id=\"h5dcd5df243\">エラーコード</h3><div data-filename=\"firebase-faild.ts\"><pre><code class=\"language-typescript\">// うごかねぇ\nimport { initializeApp } from &quot;firebase/app&quot;;\nimport { getAuth } from &quot;firebase/auth&quot;;\n//import { getAnalytics } from &quot;firebase/analytics&quot;;\n// TODO: Add SDKs for Firebase products that you want to use\n// https://firebase.google.com/docs/web/setup#available-libraries\n\n// Your web app&apos;s Firebase configuration\n// For Firebase JS SDK v7.20.0 and later, measurementId is optional\nconst firebaseConfig = {\n  apiKey: process.env.NEXT_PUBLIC_API_KEY,　// process.envではよめない\n  authDomain: process.env.NEXT_PUBLIC_AUTH_DOMAIN,\n  projectId: process.env.NEXT_PUBLIC_PROJECT_ID,\n  storageBucket: process.env.NEXT_PUBLIC_STORAGE_BUCKET,\n  messagingSenderId: process.env.NEXT_PUBLIC_MESSAGING_SENDER_ID,\n  appId: process.env.NEXT_PUBLIC_APP_ID,\n  measurementId: process.env.NEXT_PUBLIC_MEASUREMENT_ID\n};\n\n// Initialize Firebase\nconst app = initializeApp(firebaseConfig);\n//const analytics = getAnalytics(app);\nconst auth = getAuth(app);\n\nexport { auth };</code></pre></div><h3 id=\"h04757ee1c0\">修正済コード</h3><div data-filename=\"firebase.ts\"><pre><code class=\"language-typescript\">// Import the functions you need from the SDKs you need\nimport { initializeApp } from &quot;firebase/app&quot;;\nimport { getAuth } from &quot;firebase/auth&quot;;\n//import { getAnalytics } from &quot;firebase/analytics&quot;;\n// TODO: Add SDKs for Firebase products that you want to use\n// https://firebase.google.com/docs/web/setup#available-libraries\n\n// Your web app&apos;s Firebase configuration\nconst firebaseConfig = {\n  apiKey: import.meta.env.VITE_REACT_APP_API_KEY,\n  authDomain: import.meta.env.VITE_REACT_APP_AUTH_DOMAIN,\n  projectId: import.meta.env.VITE_REACT_APP_PROJECT_ID,\n  storageBucket: import.meta.env.VITE_REACT_APP_STORAGE_BUCKET,\n  messagingSenderId: import.meta.env.VITE_REACT_APP_MESSAGING_SENDER_ID,\n  appId: import.meta.env.VITE_REACT_APP_APP_ID,\n  measurementId: import.meta.env.VITE_REACT_APP_MEASUREMENT_ID\n};\n// Initialize Firebase\nconst app = initializeApp(firebaseConfig);\n//const analytics = getAnalytics(app);\nconst auth = getAuth(app);\n\nexport { auth };</code></pre></div><h3 id=\"h41e3733aef\">動かなかった原因</h3><p>認証用サイトは裏でViteを使っていたのですが、Vitejsはほかのフロントエンドフレームワークとは環境変数の読み込み方が違っており、それが原因でローカルでもデプロイ先でも画面がブラックアウトしたまま固まってしまってましたw</p><p>エラーの解消に数時間かかった...</p><h2 id=\"h2437a71527\">認証サイト</h2><p><a href=\"https://auth.varius.technology/\">https://auth.varius.technology/</a></p><h2 id=\"h3de35099b3\">参考</h2><p><a href=\"https://dash.cloudflare.com/\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">https://dash.cloudflare.com/</a></p><p><a href=\"https://qiita.com/bisketoriba/items/0b70fd5e130e8eabeeb1\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">https://qiita.com/bisketoriba/items/0b70fd5e130e8eabeeb1</a></p>","eyecatch":{"url":"https://images.microcms-assets.io/assets/a2939c8d25434ae5a1f853f2dc239a0f/b77659c0273f4e348bd11d9b2bb7830c/Cloudflare-Logo-1024x576.png","height":576,"width":1024},"category":{"id":"vx","createdAt":"2025-06-07T16:28:20.159Z","updatedAt":"2025-06-07T16:28:43.322Z","publishedAt":"2025-06-07T16:28:20.159Z","revisedAt":"2025-06-07T16:28:43.322Z","name":"vx"}}},"__N_SSG":true}